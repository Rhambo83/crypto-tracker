<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Crypto Tracker App</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; background:#f5f5f5; }
    table { border-collapse: collapse; width:100%; margin-top:1rem }
    th,td { border:1px solid #ddd; padding:.5rem; text-align:left }
    th { background:#333; color:#fff }
    h2 { margin-top: 2rem; }
  </style>
</head>
<body>
  <h1>Crypto Tracker App</h1>
  <p>Live prices for your priority tokens:</p>
  <div id="prices">Loadingâ€¦</div>

  <script>
    const coinMap = {
      'bitcoin': 'BTC',
      'ethereum': 'ETH',
      'litecoin': 'LTC',
      'xrp': 'XRP',
      'cardano': 'ADA',
      'solana': 'SOL',
      'polkadot': 'DOT',
      'binancecoin': 'BNB',
      'chainlink': 'LINK',
      'dogecoin': 'DOGE',
      'stellar': 'XLM',
      'cosmos': 'ATOM',
      'tron': 'TRX',
      'avalanche-2': 'AVAX',
      'theta-token': 'THETA'
    };

    const categories = {
      'Mainstream Coins': ['bitcoin', 'ethereum', 'litecoin'],
      'Altcoins': ['xrp', 'cardano', 'solana', 'polkadot', 'chainlink', 'stellar', 'tron'],
      'Exchange & Meme Coins': ['binancecoin', 'dogecoin'],
      'Ecosystem Coins': ['cosmos', 'avalanche-2', 'theta-token']
    };

    async function fetchPrices() {
      try {
        const ids = Object.keys(coinMap).join(',');
        const url = 'https://api.coingecko.com/api/v3/coins/markets'
          + '?vs_currency=usd'
          + '&ids=' + ids
          + '&price_change_percentage=24h';
        const res = await fetch(url);
        const data = await res.json();
        const priceData = {};
        for (const coin of data) {
          priceData[coin.id] = {
            currentPrice: coin.current_price,
            pastPrice: coin.current_price / (1 + (coin.price_change_percentage_24h / 100)),
            priceChange: coin.price_change_percentage_24h,
            currentVol: coin.total_volume,
            pastVol: coin.total_volume / (1 + (coin.price_change_percentage_24h / 100)),
            volChange: coin.total_volume === 0 ? 0 : 100 * (coin.total_volume - (coin.total_volume / (1 + (coin.price_change_percentage_24h / 100)))) / (coin.total_volume / (1 + (coin.price_change_percentage_24h / 100)))
          };
        }

        let html = '';
        for (const [category, ids] of Object.entries(categories)) {
          html += `<h2>${category}</h2>`;
          html += `<table>
            <tr>
              <th>Coin</th>
              <th>Price Current (USD)</th>
              <th>Price 24h Past (USD)</th>
              <th>24h Change %</th>
              <th>Qty Current</th>
              <th>Qty 24h Past</th>
              <th>Qty 24h Change %</th>
            </tr>`;
          for (const id of ids) {
            const coin = priceData[id];
            if (!coin) continue;
            const colorPrice = coin.priceChange >= 0 ? 'green' : 'red';
            const colorVol = coin.volChange >= 0 ? 'green' : 'red';
            html += `<tr>
              <td>${coinMap[id]}</td>
              <td>$${coin.currentPrice.toLocaleString(undefined, { minimumFractionDigits: 2 })}</td>
              <td>$${coin.pastPrice.toLocaleString(undefined, { minimumFractionDigits: 2 })}</td>
              <td style="color:${colorPrice}">${coin.priceChange.toFixed(2)}%</td>
              <td>${coin.currentVol.toLocaleString()}</td>
              <td>${coin.pastVol.toLocaleString()}</td>
              <td style="color:${colorVol}">${coin.volChange.toFixed(2)}%</td>
            </tr>`;
          }
          html += '</table>';
        }

        document.getElementById('prices').innerHTML = html;
      } catch (e) {
        document.getElementById('prices').textContent = 'Error loading data';
        console.error(e);
      }
    }

    fetchPrices();
    setInterval(fetchPrices, 60_000);
  </script>
</body>
</html>

