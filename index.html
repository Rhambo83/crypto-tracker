<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Crypto Tracker App</title>
  <style>
    body {
      font-family: sans-serif;
      background: #121212;
      color: #f0f0f0;
      padding: 2rem;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-bottom: 2rem;
    }
    th, td {
      border: 1px solid #333;
      padding: 0.5rem;
      text-align: left;
    }
    th {
      background: #222;
    }
    h2 {
      color: #00ff99;
      margin-top: 2rem;
    }
  </style>
</head>
<body>
  <h1>Crypto Tracker App</h1>
  <p>Live prices for your priority tokens:</p>
  <div id="prices">Loadingâ€¦</div>

  <script>
    const groups = {
      "Mainstream Coins": ["BTC", "ETH", "LTC"],
      "Altcoins": ["ADA", "SOL", "DOT", "LINK", "XLM", "TRX"],
      "Exchange & Meme Coins": ["BNB", "DOGE"],
      "Ecosystem Coins": ["ATOM", "AVAX", "THETA"]
    };

    const symbolToId = {
      BTC: "bitcoin",
      ETH: "ethereum",
      LTC: "litecoin",
      ADA: "cardano",
      SOL: "solana",
      DOT: "polkadot",
      LINK: "chainlink",
      XLM: "stellar",
      TRX: "tron",
      BNB: "binancecoin",
      DOGE: "dogecoin",
      ATOM: "cosmos",
      AVAX: "avalanche-2",
      THETA: "theta-token"
    };

    const idToSymbol = Object.fromEntries(Object.entries(symbolToId).map(([k,v]) => [v,k]));

    async function fetchPrices() {
      const ids = Object.values(symbolToId).join(",");
      const url = "https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=" + ids + "&price_change_percentage=1h,24h";
      const res = await fetch(url);
      const data = await res.json();

      let html = "";

      for (const [group, symbols] of Object.entries(groups)) {
        html += `<h2>${group}</h2><table><tr>
          <th>Coin</th><th>Price Current (USD)</th><th>Price 24h Past (USD)</th><th>24h Change %</th>
          <th>1h Change %</th><th>Qty Current / Max</th></tr>`;

        for (const symbol of symbols) {
          const info = data.find(c => idToSymbol[c.id] === symbol);
          if (!info) continue;

          const priceNow = info.current_price;
          const change24h = info.price_change_percentage_24h || 0;
          const price24h = priceNow / (1 + change24h / 100);
          const change1h = info.price_change_percentage_1h_in_currency || 0;

          const supply = info.circulating_supply?.toLocaleString() || "N/A";
          const max = info.max_supply ? info.max_supply.toLocaleString() : "Unlimited";

          html += `<tr>
            <td>${symbol}</td>
            <td>$${priceNow.toFixed(3)}</td>
            <td>$${price24h.toFixed(3)}</td>
            <td style="color:${change24h>=0?'limegreen':'red'}">${change24h.toFixed(2)}%</td>
            <td style="color:${change1h>=0?'limegreen':'red'}">${change1h.toFixed(2)}%</td>
            <td>${supply} / ${max}</td>
          </tr>`;
        }

        html += "</table>";
      }

      document.getElementById("prices").innerHTML = html;
    }

    fetchPrices();
    setInterval(fetchPrices, 60000);
  </script>
</body>
</html>
